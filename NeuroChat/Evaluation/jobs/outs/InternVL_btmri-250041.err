Loading safetensors checkpoint shards:   0% Completed | 0/4 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  25% Completed | 1/4 [00:01<00:04,  1.46s/it]
Loading safetensors checkpoint shards:  50% Completed | 2/4 [00:03<00:03,  1.60s/it]
Loading safetensors checkpoint shards:  75% Completed | 3/4 [00:03<00:01,  1.11s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.30s/it]
Loading safetensors checkpoint shards: 100% Completed | 4/4 [00:05<00:00,  1.32s/it]

Processed prompts:   0%|          | 0/255 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  96%|#########5| 244/255 [00:00<00:00, 1450.00it/s, est. speed input: 1124859.72 toks/s, output: 30696.26 toks/s]Processed prompts: 100%|##########| 255/255 [00:02<00:00, 113.78it/s, est. speed input: 90140.92 toks/s, output: 2421.40 toks/s]    
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  99%|#########9| 254/256 [00:00<00:00, 2355.40it/s, est. speed input: 3196333.84 toks/s, output: 44821.13 toks/s]Processed prompts: 100%|##########| 256/256 [00:01<00:00, 195.14it/s, est. speed input: 263188.99 toks/s, output: 3746.27 toks/s]   
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  99%|#########9| 254/256 [00:00<00:00, 774.12it/s, est. speed input: 1045482.22 toks/s, output: 14346.06 toks/s]Processed prompts: 100%|##########| 256/256 [00:00<00:00, 488.78it/s, est. speed input: 659186.62 toks/s, output: 9049.63 toks/s]  
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  91%|#########1| 234/256 [00:00<00:00, 2324.66it/s, est. speed input: 2963185.38 toks/s, output: 40544.69 toks/s]Processed prompts: 100%|##########| 256/256 [00:00<00:00, 341.77it/s, est. speed input: 426163.94 toks/s, output: 6034.66 toks/s]   
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  75%|#######5  | 192/256 [00:00<00:00, 1904.82it/s, est. speed input: 1710780.21 toks/s, output: 71820.21 toks/s]Processed prompts:  94%|#########3| 240/256 [00:16<00:00, 1904.82it/s, est. speed input: 13172.22 toks/s, output: 877.44 toks/s]    Processed prompts:  94%|#########4| 241/256 [00:16<00:01, 11.35it/s, est. speed input: 13134.16 toks/s, output: 870.21 toks/s]  Processed prompts:  95%|#########4| 243/256 [00:18<00:01,  9.71it/s, est. speed input: 11656.43 toks/s, output: 784.45 toks/s]Processed prompts: 100%|##########| 256/256 [00:27<00:00,  9.37it/s, est. speed input: 8411.51 toks/s, output: 593.47 toks/s] 
Processed prompts:   0%|          | 0/256 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  22%|##1       | 56/256 [00:00<00:00, 555.43it/s, est. speed input: 711277.17 toks/s, output: 81405.53 toks/s]Processed prompts:  44%|####4     | 113/256 [00:00<00:00, 563.26it/s, est. speed input: 722496.43 toks/s, output: 83751.68 toks/s]Processed prompts:  65%|######5   | 167/256 [00:19<00:00, 563.26it/s, est. speed input: 11804.44 toks/s, output: 1300.20 toks/s]  Processed prompts:  66%|######5   | 168/256 [00:19<00:13,  6.41it/s, est. speed input: 11452.06 toks/s, output: 1265.18 toks/s] Processed prompts:  66%|######6   | 169/256 [00:19<00:14,  6.20it/s, est. speed input: 11201.72 toks/s, output: 1235.03 toks/s]Processed prompts:  76%|#######5  | 194/256 [00:39<00:09,  6.20it/s, est. speed input: 6757.65 toks/s, output: 717.76 toks/s]  Processed prompts:  76%|#######6  | 195/256 [00:39<00:20,  2.95it/s, est. speed input: 6741.40 toks/s, output: 710.44 toks/s]Processed prompts:  77%|#######6  | 196/256 [00:40<00:20,  2.87it/s, est. speed input: 6597.08 toks/s, output: 697.27 toks/s]Processed prompts:  84%|########3 | 215/256 [00:54<00:19,  2.14it/s, est. speed input: 5229.54 toks/s, output: 565.89 toks/s]Processed prompts:  84%|########4 | 216/256 [00:55<00:18,  2.11it/s, est. speed input: 5217.13 toks/s, output: 560.99 toks/s]Processed prompts:  89%|########9 | 228/256 [01:03<00:15,  1.85it/s, est. speed input: 4592.57 toks/s, output: 512.89 toks/s]Processed prompts:  92%|#########2| 236/256 [01:09<00:11,  1.70it/s, est. speed input: 4292.71 toks/s, output: 484.82 toks/s]Processed prompts:  95%|#########4| 242/256 [01:14<00:08,  1.61it/s, est. speed input: 4095.12 toks/s, output: 464.96 toks/s]Processed prompts:  96%|#########6| 246/256 [01:15<00:05,  1.71it/s, est. speed input: 4031.43 toks/s, output: 462.64 toks/s]Processed prompts:  97%|#########7| 249/256 [01:19<00:04,  1.51it/s, est. speed input: 3895.78 toks/s, output: 446.83 toks/s]Processed prompts:  98%|#########8| 251/256 [01:20<00:03,  1.56it/s, est. speed input: 3888.30 toks/s, output: 445.72 toks/s]Processed prompts:  99%|#########8| 253/256 [01:22<00:02,  1.43it/s, est. speed input: 3824.24 toks/s, output: 438.55 toks/s]Processed prompts:  99%|#########9| 254/256 [01:23<00:01,  1.42it/s, est. speed input: 3794.58 toks/s, output: 436.49 toks/s]Processed prompts: 100%|#########9| 255/256 [01:23<00:00,  1.55it/s, est. speed input: 3788.52 toks/s, output: 437.24 toks/s]Processed prompts: 100%|##########| 256/256 [01:23<00:00,  1.75it/s, est. speed input: 3786.96 toks/s, output: 438.14 toks/s]Processed prompts: 100%|##########| 256/256 [01:23<00:00,  3.07it/s, est. speed input: 3786.96 toks/s, output: 438.14 toks/s]
Processed prompts:   0%|          | 0/40 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]Processed prompts:  80%|########  | 32/40 [00:00<00:00, 34.74it/s, est. speed input: 38081.23 toks/s, output: 4790.63 toks/s]Processed prompts:  90%|######### | 36/40 [00:03<00:00,  9.29it/s, est. speed input: 12322.37 toks/s, output: 1597.46 toks/s]Processed prompts:  95%|#########5| 38/40 [00:04<00:00,  5.83it/s, est. speed input: 8417.87 toks/s, output: 1122.95 toks/s] Processed prompts:  98%|#########7| 39/40 [00:05<00:00,  5.04it/s, est. speed input: 7535.67 toks/s, output: 1030.19 toks/s]Processed prompts: 100%|##########| 40/40 [00:05<00:00,  4.05it/s, est. speed input: 6623.35 toks/s, output: 917.83 toks/s] Processed prompts: 100%|##########| 40/40 [00:05<00:00,  6.67it/s, est. speed input: 6623.35 toks/s, output: 917.83 toks/s]
[rank0]:[W424 16:47:31.765927663 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
